//# sourceMappingURL=termView-mf.js.map
var regStatusPopupLayout={north__paneSelector:".regStatusPopup-ui-layout-north",center__paneSelector:".regStatusPopup-ui-layout-center",south__paneSelector:".regStatusPopup-ui-layout-south",slidable:!1,resizable:!1,spacing_open:0,spacing_closed:0},regStatusPopupCenterLayout={center__paneSelector:".regStatusPopup-ui-layout-center-inner",slidable:!1,resizable:!1,spacing_open:0,spacing_closed:0},STORAGE="xe.unique.session.storage.id",now=Date.now(),random=Math.random().toString(36).substr(2,5),stored=
sessionStorage.getItem(STORAGE);stored||sessionStorage.setItem(STORAGE,random+now);stored=sessionStorage.getItem(STORAGE);
$(document).ready(function(){var a="",e={name:"pageLayout",resizeWithWindowDelay:250,resizable:!1,slidable:!1,closable:!1,north__paneSelector:".inner-north",center__paneSelector:".inner-center",south__paneSelector:".inner-south",south__spacing_open:0,north__spacing_open:0,center__onresize:$.layout.callbacks.resizeTabLayout};"registration"==getURLParameter("mode")&&(infoIconTooltip("label[for=termSelectorDates]"),infoIconTooltip("span.bodyContentTitle",{iconcss:"info-icon-white"}));"plan"==getURLParameter("mode")&&
infoIconTooltip("label[for=term-search-combobox]");$("#content").layout(e);sessionStorage.removeItem("tabsselect");window.TermDateView=Backbone.View.extend({events:{"change #txt_term":"submitTerm","change #startDatepicker":"validateDate","change #endDatepicker":"validateDate","change #select_study_path":"changeStudyPath","click #term-go":"clickContinue",'change input[type="radio"][name=termSelector]':"datesRadioClicked",'change input[type="radio"][name=studentSearchByRadio]':"adviseeSearchType","change #searchBy":"searchByNameType",
"change #txt_advisee":"submitAdvisee"},initialize:function(){window.bootstraps.usingDates&&$("#txt_term").addClass("term-combo2-withDates");$("#searchAdvisee, .stu_pin").hide();$(".overlay").hide();setupTermSelectBindings();initAdviseeCombo();$(".search-by-name").hide();$("#studentIdRdo").prop("checked",!0);$("#txt_advisee_label").text($.i18n.prop("registration.termSelect.adviseeSearchName.searchByID"));_.bindAll(this,"render")},render:function(){var f=this;$(".required-mark").hide();$("#termStudentEligibilityErrors").hide();
$("#select_study_path, #div_study_path").disabledhidden(!0);$("#div_study_path").hasClass("other")&&$("#div_study_path").appendTo($("#searchAdvisee"));$("#input_alt_pin, #div_alt_pin").disabledhidden(!0);$("#search-dates").hide();$("input:radio[name=termSelector]").filter("[value=term]").attr("checked",!0);$("#date-range-msg").hide();$("#endDatepicker").val("");$("#startDatepicker").val("");$("#startDatepicker").multiCalendarPicker({showOn:"button",onSelect:function(a){f.validateDate($("#startDatepicker "))}});
$("#endDatepicker").multiCalendarPicker({showOn:"button",onSelect:function(a){f.validateDate($("#endDatepicker "))}});Modernizr.input.placeholder&&($("#startDatepicker").attr("placeholder",$.i18n.prop("default.date.display.format")),$("#endDatepicker").attr("placeholder",$.i18n.prop("default.date.display.format")))},showErrorNotification:function(a){var c=new Notification({message:a.message,type:"error"});c.addPromptAction($.i18n.prop("js.notification.ok"),function(){notifications.remove(c);$("#startDatepicker").focus()});
c.attributes.component=a.component;notifications.addNotification(c)},adviseeSearchType:function(a){$("#txt_advisee").select2("data",null);"name"==$("input[type='radio'][name=studentSearchByRadio]:checked").val()?($("#txt_advisee").data("select2").opts.minimumInputLength=5,$("#searchBy, label[for=searchBy]").show(),$("#searchMyStudent").show()):($("#searchBy, label[for=searchBy]").hide(),$("#searchMyStudent").hide(),0<$("#txt_advisee").length&&($("#txt_advisee").data("select2").opts.minimumInputLength=
4));a&&$("#txt_advisee_label").text($('label[for="'+a.currentTarget.id+'"]').html());a="name"==$("input[type='radio'][name=studentSearchByRadio]:checked").val()?$.i18n.prop("registration.termSelect.adviseeSearchNameFormat"):$.i18n.prop("registration.termSelect.adviseeSearchNameFormat.tooShort");$("#txt_advisee").select2("container").attr("title",$.i18n.prop("registration.termSelect.advisee.placeholder.label")+a)},searchByNameType:function(a){$("#txt_advisee").select2("data",null);$("#txt_advisee").data("select2").opts.minimumInputLength=
5},submitAdvisee:function(a){var c=this,d=$(a.currentTarget).val();$("#s2id_txt_advisee").removeClass("autoCompleteError");d?$.ajax({url:$("#txt_advisee").attr("data-save-endpoint"),data:{student:d,term:$("#txt_term").val(),uniqueSessionId:stored},success:function(b){if(b.valid){$(".selectedUserWrapper").remove();var d=$(document.createElement("div")).addClass("selectedUserWrapper").attr("aria-live","assertive"),e=$(document.createElement("div")).addClass("user-info");d.append(e);b.selectable?(e.append("<p class='inline-display'>"+
$.i18n.prop("registration.termSelect.adviseeSearchName.studentSelected",[b.displayName])+"</p>"),d.append(b.confidential?"<img class='confidential-image padding-left' src='"+window.appContext+"/images/shield.png' alt='"+$.i18n.prop("registration.termSelect.adviseeSearchName.confidentialMessage")+"'> <p class='student-desc confidential inline-display' role='alert'>"+$.i18n.prop("registration.termSelect.adviseeSearchName.confidential")+"</p>":""),d.append(b.deceased?"<img class='confidential-image padding-left' src='"+
window.appContext+"/images/icon-info.png' alt='"+$.i18n.prop("registration.termSelect.adviseeSearchName.deceasedMessage")+"'> <p class='student-desc deceased inline-display' role='alert'>"+$.i18n.prop("registration.termSelect.adviseeSearchName.deceased")+"</p>":""),b.requirePin&&d.append("<div class='margin-top'><label>"+$.i18n.prop("registration.termSelect.adviseeSearchName.studenPin")+"</label><input id='stu_pin' type='password'/></div>"),d.appendTo($("#searchAdvisee")),$("#select_study_path").empty().val(""),
$("#select_study_path").select2("data",null),$("#select_study_path").length&&(0<b.studyPath.length&&b.studyPath&&b.studyPath.length?setupStudyPath(a,b):$("#div_study_path").hide())):(c.showErrorNotification({message:b.selectableMessage}),$(".selectedUserWrapper").remove())}else c.showErrorNotification({message:$.i18n.prop("registration.faculty.invalid.access")}),$(".selectedUserWrapper").remove()},error:function(a,c,f){a=a.message?a.message:$.i18n.prop("js.net.hedtech.banner.ajax.reload.prompt");
notifications.addNotification(new Notification({message:a,type:"error",flash:!0,model:null,attribute:""}))}}):$(".selectedUserWrapper").remove()},submitTerm:function(f){a=$(f.currentTarget).val();!a||$("#txt_advisee").select2("data")||$("#txt_advisee").data("select2")||initAdviseeCombo();$(f.currentTarget).attr("listofsearchterms",a);$(f.currentTarget).removeClass("termStudentEligibilityErrors").removeClass("autoCompleteError");$("#select_study_path").empty().val("");$("#select_study_path").select2("data",
null);($("#select_study_path").length||$("#input_alt_pin").length||null!=CommonContext.user)&&""!=a?$.ajax({url:$("#txt_term").attr("data-save-endpoint"),data:{term:a,uniqueSessionId:stored},success:function(a){$("#term-go").disabled(!1);$("#select_study_path").length&&a.studyPath&&a.studyPath.length?setupStudyPath(f,a):$("#div_study_path").hide();a.enterPin&&($("#input_alt_pin, #div_alt_pin").disabledhidden(!1),$("#input_alt_pin").attr("tabindex",0).attr("aria-live","assertive").attr("aria-relevant",
"all"),$(".required-mark").show());a.studentReset&&($(".selectedUserWrapper").empty(),$("#txt_advisee").select2("data",null),$("#txt_advisee").val(""));$("#searchAdvisee").show();$(".search-by-name").show();notifications.clearNotifications()},error:function(a,f,b){a=a.message?a.message:$.i18n.prop("js.net.hedtech.banner.ajax.reload.prompt");notifications.addNotification(new Notification({message:a,type:"error",flash:!0,model:null,attribute:""}))},complete:function(){window.setTimeout(function(){var a=
$("fieldset :input:visible:enabled");0<a.eq(a.index($(".select2-container-active > input"))+1).length?a.eq(a.index($(".select2-container-active > input"))+1).focus():$("#term-go").focus()},0)}}):$("#term-go").disabled(!1);$("#s2id_txt_term").removeClass("termStudentEligibilityErrors").removeClass("autoCompleteError");$("#input_alt_pin, #stu_pin").removeClass("autoCompleteError");$(".termStudentEligibilityErrors, span.termStudentEligibilityErrors").remove()},termRadioClicked:function(a){$("#search-dates").hide();
$("#startDatepicker").val("");$("#endDatepicker").val("");$("#startDatepicker").attr("readonly",!1);$("#endDatepicker").attr("readonly",!1);$("#term-search-combobox").show();$("#endDatepicker").removeClass("autoCompleteError");$("#startDatepicker").removeClass("autoCompleteError");notifications.clearNotifications()},datesRadioClicked:function(a){"date"==$(a.currentTarget).val()?($("#search-dates").show(),$("#term-search-combobox").hide(),$("#txt_term").select2("data",null),$("#txt_term").attr("listofsearchterms",
""),$("#s2id_txt_term").removeClass("termStudentEligibilityErrors").removeClass("autoCompleteError"),$("#div_study_path").hide(),notifications.clearNotifications()):this.termRadioClicked(a)},clickContinue:function(a){var c=$("#startDatepicker").val()==$.i18n.prop("default.date.display.format")?"":$("#startDatepicker").val();""!=c&&(c=$.multicalendar.formatCDateObject($.multicalendar.parse(c,$.i18n.prop("default.calendar")),$.i18n.prop("js.datepicker.dateFormat"),$.i18n.prop("default.calendar")));
var d=$("#endDatepicker").val()==$.i18n.prop("default.date.display.format")?"":$("#endDatepicker").val();""!=d&&(d=$.multicalendar.formatCDateObject($.multicalendar.parse(d,$.i18n.prop("default.calendar")),$.i18n.prop("js.datepicker.dateFormat"),$.i18n.prop("default.calendar")));if(!("undefined"!=typeof $("#txt_term").attr("listofsearchterms")&&""!=$("#txt_term").attr("listofsearchterms")||""!=c&&""!=d)){var b=new Notification({type:"error"});$("#termSelectorDates").is(":checked")?(""==$("#endDatepicker").val()&&
(b.attributes.component=$("#endDatepicker")),""==$("#startDatepicker").val()&&(b.attributes.component=$("#startDatepicker")),b.attributes.message=$.i18n.prop("registration.classSearch.mustSelectDates")):(b.attributes.message=$.i18n.prop("registration.classSearch.mustSelectTerm"),b.attributes.component=$(".term-combo2"),b.attributes.componentType="select2");b.addPromptAction($.i18n.prop("js.notification.ok"),function(){notifications.remove(b);$("#startDatepicker").focus()});notifications.addNotification(b);
return!1}if($("#termSelectorDates").is(":checked")&&!window.termDateView.validateDate($("#term-go")))return!1;if($("#txt_advisee").length&&(""==$("#txt_advisee").val()||null==$("#txt_advisee").val()))return b=new Notification({type:"error",component:$("#txt_advisee")}),b.attributes.message=$.i18n.prop("registration.noStudentSelected"),b.addPromptAction($.i18n.prop("js.notification.ok"),function(){notifications.remove(b);$("#txt_advisee").focus()}),notifications.addNotification(b),$("#s2id_txt_advisee").addClass("autoCompleteError"),
!1;if($("#stu_pin").length&&$("#stu_pin").is(":visible")&&(""==$("#stu_pin").val().trim()||null==$("#stu_pin").val()))return b=new Notification({type:"error",component:$("#stu_pin")}),b.attributes.message=$.i18n.prop("registration.noPasswordEntered"),b.addPromptAction($.i18n.prop("js.notification.ok"),function(){notifications.remove(b);$("#stu_pin").focus()}),notifications.addNotification(b),!1;notifications.clearNotifications();$(".termStudentEligibilityErrors, span.termStudentEligibilityErrors").remove();
$("#term-go").disabled(!0);showLoading($("#term-date-selection"));$.ajax({url:$(a.currentTarget).attr("data-endpoint"),type:"POST",data:{term:$("#txt_term").attr("listofsearchterms"),studyPath:$("#select_study_path").val()?$("#select_study_path").val():"",studyPathText:$("#select_study_path option:selected").text(),student:$("#txt_advisee").val(),altPin:$("#input_alt_pin").val(),stu_pin:$("#stu_pin").val(),holdPassword:$("#holdPassword").val(),startDatepicker:c,endDatepicker:d,uniqueSessionId:stored},
success:function(a){a.regAllowed&&a.studentEligValid||"undefined"==typeof a.studentEligValid&&"undefined"==typeof a.regAllowed?window.location.href=a.fwdURL:(hideLoading($("#term-date-selection")),_.each(a.studentEligFailures,function(a){var f=new Notification({message:a.replace(/\n/g,"<br/>"),type:"error",flash:!1,component:$("#term-go")});f.addPromptAction($.i18n.prop("js.notification.ok"),function(){notifications.remove(f)});notifications.addNotification(f);f.attributes.component=$(".term-combo2");
f.attributes.componentType="select2";return!1}),a.studyPathRequired&&$("#s2id_select_study_path").addClass("autoCompleteError").after("<div class='termStudentEligibilityErrors'>"+a.studyPathRequiredMessage+"</div>"),a.invalidPin&&$("#input_alt_pin").addClass("autoCompleteError").after("<div class='termStudentEligibilityErrors'>"+a.invalidPinMessage+"</div>"),a.invalidStudent&&$("#stu_pin").addClass("autoCompleteError").after("<div class='termStudentEligibilityErrors padding-less'>"+a.invalidStuPMessage+
"</div>"),a.holdPasswordRequired&&($(".hold-wrapper").remove(),$(".selectedUserWrapper").append("<div class='hold-wrapper'><label>"+$.i18n.prop("registration.holdsPassword")+"</label><input id='holdPassword' type='password'/></div>")),"undefined"!=typeof $("#txt_term").attr("listofsearchterms")&&""!=$("#txt_term").attr("listofsearchterms")||""!=c&&""!=d||($("#termSelectorDates").is(":checked")?($("#endDatepicker").addClass("autoCompleteError"),$("#startDatepicker").addClass("autoCompleteError")):
$("#s2id_txt_term").addClass("autoCompleteError")))},error:function(a,f,b){hideLoading($("#term-date-selection"));notifications.addNotification(new Notification({message:a.message,type:"error",flash:!1,model:null,attribute:""}))},complete:function(){$("#term-go").disabled(!1)}})},changeStudyPath:function(a){""!=$("#select_study_path").val()&&($("#s2id_select_study_path").removeClass("autoCompleteError").next(".termStudentEligibilityErrors").remove(),$("#s2id_txt_term").removeClass("autoCompleteError"))},
validateDate:function(a){a=$("change"===a.type?a.currentTarget:a);var c=!1,d=$("#startDatepicker").val()==$.i18n.prop("default.date.display.format")?"":$("#startDatepicker").val(),b=$("#endDatepicker").val()==$.i18n.prop("default.date.display.format")?"":$("#endDatepicker").val();if(""!==a.val())try{var e=$.multicalendar.parse(a.val(),$.i18n.prop("default.calendar"));a.removeClass("termStudentEligibilityErrors");c=!0;if(!validateDate(a.val())||1==e._year.toString().length||3==e._year.toString().length)throw c=
!1,Error({message:$.i18n.prop("termselection.invalid.date")});}catch(l){this.showErrorNotification({message:$.i18n.prop("termselection.invalid.date"),component:a}),c=!1}else""==a.val()&&a.removeClass("termStudentEligibilityErrors").removeClass("invalid-date-error-state");if(($("#input_alt_pin").length||null!=CommonContext.user)&&d&&b&&c){var k="";$.ajax({url:$("#txt_term").attr("data-save-endpoint"),data:{startDatepicker:$("#startDatepicker").val(),endDatepicker:$("#endDatepicker").val(),uniqueSessionId:stored},
success:function(a){k=a.maxterm;return{term:k}},error:function(a,b,c){a=a.message?a.message:$.i18n.prop("js.net.hedtech.banner.ajax.reload.prompt");notifications.addNotification(new Notification({message:a,type:"error",flash:!0,model:null,attribute:""}))}})}if(a.hasClass("form-button"))try{a=$("#startDatepicker");var g=$.multicalendar.parse(d,$.i18n.prop("default.calendar"));a=$("#endDatepicker");var h=$.multicalendar.parse(b,$.i18n.prop("default.calendar"));""!=d&&""!=b&&(0<g.compareTo(h)?(this.showErrorNotification({message:$.i18n.prop("termselection.invalid.range.date"),
component:$("#endDatepicker")}),c=!1):c=!0);validateDate(d)&&1!=g._year.toString().length&&3!=g._year.toString().length||(c=!1);validateDate(b)&&1!=h._year.toString().length&&3!=h._year.toString().length||(c=!1)}catch(l){this.showErrorNotification({message:$.i18n.prop("termselection.invalid.date"),component:a}),c=!1}c&&($("#startDatepicker, #endDatepicker").removeClass("invalid-date-error-state"),notifications.clearNotifications());return c}});$("#txt_term").val()&&$("#searchAdvisee").show();$("#studentIdRdo").prop("checked",
!0);$("#searchBy, label[for=searchBy]").hide();$("#searchMyStudent").hide();$("#searchAdvisee").length&&$("#txt_term").val()?$("#searchAdvisee").show():$("#searchAdvisee, .stu_pin").hide();window.termDateView=new TermDateView({el:"#term-date-selection",bootstraps:window.bootstraps});window.termDateView.render()});
function setupStudyPath(a,e){a="";for(var f=e.studyPath.length,c=0;c<f;c++)a+='<option value="'+e.studyPath[c].keySequenceNumber+'">'+e.studyPath[c].studyPathName+"</option>";$("#div_study_path").show();$("#select_study_path").append(a);$("#select_study_path, #div_study_path").disabledhidden(!1);$("#select_study_path").addClass("select_study_path").attr("tabindex",0).attr("aria-live","assertive").attr("aria-relevant","all");$("#select_study_path").show().select2({minimumResultsForSearch:-1});$("#select_study_path").on("select2-open",
function(a){$("#select2-drop-undermask").remove()})}
function setupTermSelectBindings(){$("#txt_term").select2({multiple:!1,tokenSeparators:[","," "],closeOnSelect:!0,escapeMarkup:function(a){return a},formatSearching:function(){return $.i18n.prop("registration.termSelect.searching")},formatNoMatches:function(a){if(_.isEmpty(a)&&("plan"==getURLParameter("mode")||"registration"==getURLParameter("mode"))){$("#txt_term").select2("close");var e=new Notification({message:$.i18n.prop("registration.termSelect.noTermsAvailableNC"),type:"error",flash:!1});e.addPromptAction($.i18n.prop("registration.termSelect.returnToPreviousNC"),
function(){notifications.remove(e);window.location=getAppUrl()});notifications.addNotification(e)}return $.i18n.prop("registration.termSelect.noMatches")},formatResult:termFormatResult,ajax:{url:$("#txt_term").attr("data-endpoint"),dataType:"json",quietMillis:500,data:function(a,e){return{searchTerm:a,offset:e,max:10}},results:function(a,e){e=!(0==a.length||10>a.length);var f=[];$.each(a,function(a,d){f.push({id:d.code,text:d.description})});$("#txt_term").trigger("select2-loaded",a.length);return{results:f,
more:e}}},initSelection:function(a,e){$(a).attr("data-init-text")&&$.ajax($("#txt_term").attr("data-endpoint"),{data:{searchTerm:$(a).attr("data-init-text"),offset:1,max:1}}).done(function(a){a&&1==a.length&&($("#txt_term").attr("listofsearchterms",a[0].code),e({id:a[0].code,text:a[0].description}),$("#txt_term").data("select2-change-triggered",!0),$("#txt_term").trigger("change"))})}});$("#txt_term").select2("container").attr("title",$.i18n.prop("registration.termSelect.term.placeholder.label")).attr("aria-required",
!0);$("#txt_term").on("select2-open",function(a){$("#select2-drop-undermask").remove();$("#txt_term").select2("dropdown").find("input").removeAttr("tabindex")});$("#txt_term").on("select2-close",function(a){$(this).select2("container").removeClass("select2-container-active")}).on("select2-loaded",function(a){$(this).select2("positionDropdown")})}function termFormatResult(a){return"<div id='"+a.id+"'>"+a.text+"</div>"}
function initAdviseeCombo(){$("#txt_advisee").select2({multiple:!1,tokenSeparators:[","," "],closeOnSelect:!0,formatSearching:function(){return"name"!=$("input[type='radio'][name=studentSearchByRadio]:checked").val()||/[a-zA-Z]*,.[a-zA-Z]*/.test($("#txt_advisee").data("select2").search.val())?$.i18n.prop("registration.termSelect.searching"):$.i18n.prop("registration.termSelect.adviseeSearchNameFormat")},formatLoadMore:function(){return $.i18n.prop("registration.common.loading")},formatInputTooShort:function(a,
e){return"name"==$("input[type='radio'][name=studentSearchByRadio]:checked").val()?$.i18n.prop("registration.termSelect.adviseeSearchNameFormat"):$.i18n.prop("registration.termSelect.adviseeSearchNameFormat.tooShort")},minimumInputLength:4,quietMillis:500,ajax:getAdviseeData(),formatResult:adviseeFormatResult});$("#txt_advisee").select2("container").attr("role","combobox");$("#txt_advisee").on("select2-open",function(a){$(this.previousSibling).attr("role");a="name"==$("input[type='radio'][name=studentSearchByRadio]:checked").val()?
$.i18n.prop("registration.termSelect.adviseeSearchNameFormat"):$.i18n.prop("registration.termSelect.adviseeSearchNameFormat.tooShort");$("#txt_advisee").select2("container").attr("title",$.i18n.prop("registration.termSelect.advisee.placeholder.label")+a);$("#txt_advisee").select2("dropdown").find("input").removeAttr("tabindex")});$("#txt_advisee").on("select2-close",function(a){$(this).select2("container").removeClass("select2-container-active")}).on("select2-loaded",function(a){$(this).select2("positionDropdown")})}
function adviseeFormatResult(a){return"<div id='"+a.id+"'>"+a.text+"<br/>"+a.id+" "+a.currentIdName+"</div>"}
function getAdviseeData(){return{url:$("#txt_advisee").attr("data-endpoint"),transport:adviseeTransport,dataType:"json",quietMillis:500,data:function(a,e){return{type:$("input[type='radio'][name=studentSearchByRadio]:checked").val(),searchTerm:a,term:$("#txt_term").val(),searchBy:$("#searchBy").val(),offset:e,max:10}},results:function(a,e){e=!(0==a.length||10>a.length);var f=[];$.each(a,function(a,d){f.push({id:d.bannerId,text:d.lastName+", "+d.firstName+" "+d.middleName,currentIdName:d.currentIdName,
confidential:d.confidential})});return{results:f,more:e}}}}var adviseeTransport=function(a){if(/[a-zA-Z]*,.[a-zA-Z]*/.test(a.data.searchTerm)&&"name"==$("input[type='radio'][name=studentSearchByRadio]:checked").val()||"id"==$("input[type='radio'][name=studentSearchByRadio]:checked").val())return a=$.get(a.url,a.data).success(a.success),a.abort=function(){return null},a;$("#txt_advisee").data("select2").search.removeClass("select2-active");return null};